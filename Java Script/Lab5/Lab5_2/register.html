<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register</title>

<style>
body {
    font-family: Arial;
    background:#f0f0f0;
    padding:20px;
}
.container {
    max-width:500px;
    margin:auto;
    background:#fff;
    padding:30px;
    border-radius:10px;
}
.form-group { margin-bottom:15px; }
input, textarea {
    width:100%;
    padding:8px;
    box-sizing:border-box;
}
button {
    width:100%;
    padding:10px;
    background:green;
    color:#fff;
    border:none;
    cursor:pointer;
}
.warning {
    display:none;
    background:#fff3cd;
    padding:10px;
    margin-bottom:10px;
    border-left:4px solid #f0ad4e;
    border-radius:4px;
}
</style>
</head>

<body>

<div class="container">

<h2>Registration Form</h2>

<div class="warning" id="warning">
    ⚠️ Session expires in <span id="countdown">10</span> seconds
</div>

<form onsubmit="submitForm(event)">

    <div class="form-group">
        <label>Name</label>
        <input type="text" id="name" required>
    </div>

    <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" required>
    </div>

    <div class="form-group">
        <label>Job Title</label>
        <input type="text" id="jobTitle" required>
    </div>

    <div class="form-group">
        <label>Mobile</label>
        <input type="tel" id="mobile" required>
    </div>

    <div class="form-group">
        <label>Gender</label><br>
        <input type="radio" name="gender" value="Male" required> Male
        <input type="radio" name="gender" value="Female"> Female
    </div>

    <div class="form-group">
        <label>Address</label>
        <textarea id="address" required></textarea>
    </div>

    <button type="submit">Register</button>

</form>
</div>

<script>
let timeoutTimer;
let warningTimer;
let countdownTimer;
let countdown = 10; // seconds shown in warning (fires 20s into inactivity, counts down 10s)

startTimer();

document.querySelectorAll("input, textarea").forEach(el => {
    el.addEventListener("input", resetTimer);
});

// Also reset on radio button change
document.querySelectorAll("input[type='radio']").forEach(el => {
    el.addEventListener("change", resetTimer);
});

function startTimer() {
    countdown = 10;
    document.getElementById("countdown").innerText = countdown;
    document.getElementById("warning").style.display = "none";

    // Redirect to failed.html after 30 seconds of inactivity
    timeoutTimer = setTimeout(() => {
        window.location.href = "failed.html";
    }, 30000);

    // Show warning after 20 seconds (10s before timeout)
    warningTimer = setTimeout(() => {
        document.getElementById("warning").style.display = "block";

        countdownTimer = setInterval(() => {
            countdown--;
            document.getElementById("countdown").innerText = countdown;

            if (countdown <= 0) {
                clearInterval(countdownTimer);
            }
        }, 1000);

    }, 20000);
}

function resetTimer() {
    clearTimeout(timeoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    startTimer();
}

function submitForm(e) {
    e.preventDefault();

    clearTimeout(timeoutTimer);
    clearTimeout(warningTimer);
    clearInterval(countdownTimer);

    localStorage.setItem("name",   document.getElementById("name").value);
    localStorage.setItem("email",  document.getElementById("email").value);
    localStorage.setItem("job",    document.getElementById("jobTitle").value);
    localStorage.setItem("mobile", document.getElementById("mobile").value);
    localStorage.setItem("gender", document.querySelector("input[name='gender']:checked").value);
    localStorage.setItem("address",document.getElementById("address").value);

    window.location.href = "welcome.html";
}
</script>

</body>
</html>